<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MESUT TEKNO MARKET - √úr√ºn Y√∂netimi</title>
  <style>
    :root {
      --bg: #1e1e2f;
      --card: #2c2f4a;
      --text: #ffffff;
      --accent: #4e8cff;
      --danger: #ff4d4f;
      --success: #28c76f;
      --warning: #ffc107;
      --info: #17a2b8;
      --border: #3c3f5a;
      --low-stock: #ff6b6b;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
      background-color: var(--bg);
      color: var(--text);
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .header h1 {
      color: var(--accent);
      margin: 0;
      font-size: 2.2em;
    }

    .main-content {
      max-width: 1400px;
      margin: auto;
      background: var(--card);
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 0 30px rgba(0,0,0,0.3);
    }

    .form-control, .btn, .search-box, .category-select {
      padding: 12px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background-color: #1c1c2b;
      color: var(--text);
    }

    .btn {
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
      border: none;
    }

    .btn-success { background-color: var(--success); color: #fff; }
    .btn-danger { background-color: var(--danger); color: #fff; }
    .btn-primary { background-color: var(--accent); color: #fff; }
    .btn-warning { background-color: var(--warning); color: #000; }
    .btn-info { background-color: var(--info); color: #fff; }

    .btn:hover { opacity: 0.9; }

    .form-row {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      align-items: end;
    }

    .form-group {
      flex: 1;
      min-width: 150px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      color: var(--accent);
      font-weight: bold;
    }

    .product-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .product-card {
      background-color: var(--card);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
      text-align: center;
      transition: transform 0.2s;
      position: relative;
    }

    .product-card:hover {
      transform: scale(1.02);
    }

    .low-stock {
      border: 2px solid var(--low-stock);
    }

    .stock-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 5px 10px;
      border-radius: 15px;
      font-size: 0.8em;
      font-weight: bold;
    }

    .stock-high { background: var(--success); color: #fff; }
    .stock-medium { background: var(--warning); color: #000; }
    .stock-low { background: var(--danger); color: #fff; }

    .product-card img {
      max-width: 100%;
      height: 150px;
      object-fit: contain;
      margin-bottom: 10px;
      border-radius: 8px;
      background-color: #fff;
    }

    .product-name {
      font-weight: bold;
      font-size: 1.1em;
      color: #fff;
      margin-bottom: 8px;
    }

    .product-price {
      color: var(--success);
      margin: 5px 0;
      font-size: 1.2em;
      font-weight: bold;
    }

    .product-info {
      font-size: 0.9em;
      color: #ccc;
      margin: 3px 0;
    }

    .product-actions {
      display: flex;
      gap: 8px;
      justify-content: center;
      margin-top: 15px;
      flex-wrap: wrap;
    }

    .action-btn {
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      font-size: 0.85em;
      flex: 1;
      min-width: 70px;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.7);
      overflow-y: auto;
    }

    .modal-content {
      background-color: var(--card);
      margin: 2% auto;
      padding: 30px;
      border-radius: 15px;
      width: 95%;
      max-width: 600px;
      box-shadow: 0 0 30px rgba(0,0,0,0.5);
    }

    .modal h2 {
      color: var(--accent);
      margin-bottom: 20px;
      text-align: center;
    }

    .modal-form {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .modal-actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-top: 20px;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      margin-top: -20px;
    }

    .close:hover { color: #fff; }

    .alert {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .alert-warning {
      background: rgba(255, 193, 7, 0.2);
      border-left: 4px solid var(--warning);
      color: var(--warning);
    }

    @media (max-width: 768px) {
      .form-row {
        flex-direction: column;
      }
      
      .product-actions {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>üè™ MESUT TEKNO MARKET</h1>
    <p>√úr√ºn Y√∂netim Sistemi</p>
  </div>

  <div class="main-content">
    <form id="productForm">
      <div class="form-row">
        <div class="form-group">
          <label>√úr√ºn Adƒ± *</label>
          <input type="text" id="productName" class="form-control" required />
        </div>
        <div class="form-group">
          <label>Barkod *</label>
          <input type="text" id="productBarcode" class="form-control" required />
        </div>
        <div class="form-group">
          <label>Fiyat (‚Ç∫) *</label>
          <input type="number" id="productPrice" class="form-control" step="0.01" min="0" required />
        </div>
        <div class="form-group">
          <label>Stok Miktarƒ± *</label>
          <input type="number" id="productStock" class="form-control" min="0" required />
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Kategori *</label>
          <select id="productCategory" class="form-control" required>
            <option value="">Kategori Se√ß</option>
          </select>
        </div>
        <div class="form-group">
          <label>Min. Stok Uyarƒ±sƒ±</label>
          <input type="number" id="productMinStock" class="form-control" min="0" value="5" />
        </div>
        <div class="form-group">
          <label>G√∂rsel URL</label>
          <input type="url" id="productImage" class="form-control" />
        </div>
        <div class="form-group">
          <button type="submit" class="btn btn-success">‚úÖ √úr√ºn Ekle</button>
        </div>
      </div>
    </form>

    <div class="form-row">
      <input type="text" id="searchInput" class="form-control" placeholder="√úr√ºn ara..." />
      <select id="categoryFilter" class="category-select">
        <option value="">T√ºm Kategoriler</option>
      </select>
      <select id="sortFilter" class="category-select">
        <option value="">Sƒ±ralama</option>
        <option value="name">ƒ∞sme G√∂re</option>
        <option value="price-low">Ucuzdan Pahalƒ±ya</option>
        <option value="price-high">Pahalƒ±dan Ucuza</option>
        <option value="stock-low">D√º≈ü√ºk Stok</option>
      </select>
    </div>

    <div class="form-row">
      <input type="text" id="newCategory" class="form-control" placeholder="Yeni kategori..." />
      <button id="addCategoryBtn" class="btn btn-primary">üìÅ Kategori Ekle</button>
    </div>

    <div id="lowStockAlert"></div>
    <div class="product-container" id="productContainer"></div>
  </div>

  <!-- Edit Modal -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>√úr√ºn D√ºzenle</h2>
      <form id="editForm" class="modal-form">
        <div class="form-group">
          <label>√úr√ºn Adƒ±</label>
          <input type="text" id="editName" class="form-control" required />
        </div>
        <div class="form-group">
          <label>Barkod</label>
          <input type="text" id="editBarcode" class="form-control" required />
        </div>
        <div class="form-group">
          <label>Fiyat (‚Ç∫)</label>
          <input type="number" id="editPrice" class="form-control" step="0.01" required />
        </div>
        <div class="form-group">
          <label>Stok Miktarƒ±</label>
          <input type="number" id="editStock" class="form-control" required />
        </div>
        <div class="form-group">
          <label>Kategori</label>
          <select id="editCategory" class="form-control" required>
            <option value="">Kategori Se√ß</option>
          </select>
        </div>
        <div class="form-group">
          <label>Min. Stok</label>
          <input type="number" id="editMinStock" class="form-control" />
        </div>
        <div class="form-group">
          <label>G√∂rsel URL</label>
          <input type="url" id="editImage" class="form-control" />
        </div>
        <div class="modal-actions">
          <button type="submit" class="btn btn-success">üíæ Kaydet</button>
          <button type="button" id="cancelEdit" class="btn btn-danger">‚ùå ƒ∞ptal</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Stock Modal -->
  <div id="stockModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeStockModal()">&times;</span>
      <h2>Stok G√ºncelle</h2>
      <form id="stockForm" class="modal-form">
        <div class="form-group">
          <label>√úr√ºn: <span id="stockProductName"></span></label>
          <label>Mevcut Stok: <span id="currentStockAmount"></span></label>
        </div>
        <div class="form-group">
          <label>ƒ∞≈ülem T√ºr√º</label>
          <select id="stockOperation" class="form-control">
            <option value="add">Stok Ekle (+)</option>
            <option value="remove">Stok √áƒ±kar (-)</option>
            <option value="set">Stok Belirle (=)</option>
          </select>
        </div>
        <div class="form-group">
          <label>Miktar</label>
          <input type="number" id="stockAmount" class="form-control" min="0" required />
        </div>
        <div class="modal-actions">
          <button type="submit" class="btn btn-success">üíæ G√ºncelle</button>
          <button type="button" onclick="closeStockModal()" class="btn btn-danger">‚ùå ƒ∞ptal</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // Global Variables
    let products = JSON.parse(localStorage.getItem('products')) || [];
    let categories = JSON.parse(localStorage.getItem('categories')) || ['Elektronik', 'Gƒ±da', 'ƒ∞√ßecek', 'Temizlik'];
    let editingIndex = -1;
    let stockEditIndex = -1;

    // Elements
    const elements = {
      productContainer: document.getElementById('productContainer'),
      productForm: document.getElementById('productForm'),
      editModal: document.getElementById('editModal'),
      stockModal: document.getElementById('stockModal')
    };

    // Save Data
    function saveData() {
      localStorage.setItem('products', JSON.stringify(products));
      localStorage.setItem('categories', JSON.stringify(categories));
    }

    // Product Management
    function renderProducts(filterText = "", filterCategory = "", sortType = "") {
      let filtered = products.filter(p =>
        (p.name.toLowerCase().includes(filterText.toLowerCase()) ||
         p.barcode.includes(filterText)) &&
        (filterCategory === "" || p.category === filterCategory)
      );

      // Sorting
      if (sortType === 'name') {
        filtered.sort((a, b) => a.name.localeCompare(b.name, 'tr'));
      } else if (sortType === 'price-low') {
        filtered.sort((a, b) => a.price - b.price);
      } else if (sortType === 'price-high') {
        filtered.sort((a, b) => b.price - a.price);
      } else if (sortType === 'stock-low') {
        filtered.sort((a, b) => a.stock - b.stock);
      }

      elements.productContainer.innerHTML = "";
      
      if (filtered.length === 0) {
        elements.productContainer.innerHTML = "<p style='text-align:center; color:#ccc;'>√úr√ºn bulunamadƒ±.</p>";
        return;
      }

      // Low stock alert
      const lowStockProducts = filtered.filter(p => p.stock <= p.minStock);
      if (lowStockProducts.length > 0) {
        document.getElementById('lowStockAlert').innerHTML = `
          <div class="alert alert-warning">
            ‚ö†Ô∏è <strong>${lowStockProducts.length} √ºr√ºn</strong> d√º≈ü√ºk stokta! Stok yenileme gerekiyor.
          </div>
        `;
      } else {
        document.getElementById('lowStockAlert').innerHTML = "";
      }

      filtered.forEach((product, index) => {
        const actualIndex = products.findIndex(p => p.barcode === product.barcode);
        const stockStatus = getStockStatus(product.stock, product.minStock);
        
        const card = document.createElement('div');
        card.className = `product-card ${product.stock <= product.minStock ? 'low-stock' : ''}`;
        
        card.innerHTML = `
          <div class="stock-badge ${stockStatus.class}">${product.stock} adet</div>
          <img src="${product.image || 'https://via.placeholder.com/150?text=√úr√ºn'}" alt="${product.name}" onerror="this.src='https://via.placeholder.com/150?text=Resim+Yok'">
          <div class="product-name">${product.name}</div>
          <div class="product-price">${product.price.toFixed(2)} ‚Ç∫</div>
          <div class="product-info">Barkod: ${product.barcode}</div>
          <div class="product-info">Kategori: ${product.category}</div>
          <div class="product-info">Stok: ${product.stock} / Min: ${product.minStock}</div>
          <div class="product-actions">
            <button class="action-btn btn-warning" onclick="editProduct(${actualIndex})">‚úèÔ∏è D√ºzenle</button>
            <button class="action-btn btn-primary" onclick="updateStock(${actualIndex})">üì¶ Stok</button>
            <button class="action-btn btn-danger" onclick="deleteProduct(${actualIndex})">üóëÔ∏è Sil</button>
          </div>
        `;
        
        elements.productContainer.appendChild(card);
      });
    }

    function getStockStatus(stock, minStock) {
      if (stock <= minStock) return { class: 'stock-low', text: 'D√º≈ü√ºk' };
      if (stock <= minStock * 2) return { class: 'stock-medium', text: 'Orta' };
      return { class: 'stock-high', text: 'Y√ºksek' };
    }

    function renderCategories() {
      const selects = ['productCategory', 'categoryFilter', 'editCategory'];
      selects.forEach(selectId => {
        const select = document.getElementById(selectId);
        const currentValue = select.value;
        select.innerHTML = selectId === 'categoryFilter' ? 
          '<option value="">T√ºm Kategoriler</option>' : 
          '<option value="">Kategori Se√ß</option>';
        
        categories.forEach(cat => {
          select.innerHTML += `<option value="${cat}">${cat}</option>`;
        });
        
        select.value = currentValue;
      });
    }

    // Kategori Ekleme Fonksiyonu
    function addCategory() {
      const newCategoryInput = document.getElementById('newCategory');
      const categoryName = newCategoryInput.value.trim();
      
      if (!categoryName) {
        alert('Kategori adƒ± bo≈ü olamaz!');
        return;
      }
      
      if (categories.includes(categoryName)) {
        alert('Bu kategori zaten mevcut!');
        return;
      }
      
      categories.push(categoryName);
      saveData();
      renderCategories();
      newCategoryInput.value = '';
      alert(`"${categoryName}" kategorisi ba≈üarƒ±yla eklendi!`);
    }

    // Product Operations
    function addProduct(event) {
      event.preventDefault();
      
      const product = {
        name: document.getElementById('productName').value.trim(),
        barcode: document.getElementById('productBarcode').value.trim(),
        price: parseFloat(document.getElementById('productPrice').value),
        stock: parseInt(document.getElementById('productStock').value),
        category: document.getElementById('productCategory').value,
        minStock: parseInt(document.getElementById('productMinStock').value) || 5,
        image: document.getElementById('productImage').value.trim()
      };

      // Validation
      if (products.some(p => p.barcode === product.barcode)) {
        alert('Bu barkod zaten mevcut!');
        return;
      }

      products.push(product);
      saveData();
      renderProducts();
      elements.productForm.reset();
      alert('√úr√ºn ba≈üarƒ±yla eklendi!');
    }

    function editProduct(index) {
      editingIndex = index;
      const product = products[index];
      
      document.getElementById('editName').value = product.name;
      document.getElementById('editBarcode').value = product.barcode;
      document.getElementById('editPrice').value = product.price;
      document.getElementById('editStock').value = product.stock;
      document.getElementById('editCategory').value = product.category;
      document.getElementById('editMinStock').value = product.minStock;
      document.getElementById('editImage').value = product.image || '';
      
      elements.editModal.style.display = 'block';
    }

    function saveEdit(event) {
      event.preventDefault();
      
      const updatedProduct = {
        name: document.getElementById('editName').value.trim(),
        barcode: document.getElementById('editBarcode').value.trim(),
        price: parseFloat(document.getElementById('editPrice').value),
        stock: parseInt(document.getElementById('editStock').value),
        category: document.getElementById('editCategory').value,
        minStock: parseInt(document.getElementById('editMinStock').value),
        image: document.getElementById('editImage').value.trim()
      };

      // Check for duplicate barcode (excluding current product)
      if (products.some((p, i) => p.barcode === updatedProduct.barcode && i !== editingIndex)) {
        alert('Bu barkod zaten ba≈üka bir √ºr√ºnde kullanƒ±lƒ±yor!');
        return;
      }

      products[editingIndex] = updatedProduct;
      saveData();
      renderProducts();
      elements.editModal.style.display = 'none';
      alert('√úr√ºn ba≈üarƒ±yla g√ºncellendi!');
    }

    function deleteProduct(index) {
      if (confirm('Bu √ºr√ºn√º silmek istediƒüinizden emin misiniz?')) {
        products.splice(index, 1);
        saveData();
        renderProducts();
        alert('√úr√ºn silindi!');
      }
    }

    function updateStock(index) {
      stockEditIndex = index;
      const product = products[index];
      
      document.getElementById('stockProductName').textContent = product.name;
      document.getElementById('currentStockAmount').textContent = product.stock;
      document.getElementById('stockAmount').value = '';
      
      elements.stockModal.style.display = 'block';
    }

    function saveStock(event) {
      event.preventDefault();
      
      const operation = document.getElementById('stockOperation').value;
      const amount = parseInt(document.getElementById('stockAmount').value);
      const product = products[stockEditIndex];
      
      if (operation === 'add') {
        product.stock += amount;
      } else if (operation === 'remove') {
        product.stock = Math.max(0, product.stock - amount);
      } else if (operation === 'set') {
        product.stock = amount;
      }
      
      saveData();
      renderProducts();
      elements.stockModal.style.display = 'none';
      alert('Stok ba≈üarƒ±yla g√ºncellendi!');
    }

    function closeStockModal() {
      elements.stockModal.style.display = 'none';
    }

    // Event Listeners
    document.addEventListener('DOMContentLoaded', function() {
      // Kategori ekleme butonu
      document.getElementById('addCategoryBtn').addEventListener('click', addCategory);
      
      // Enter tu≈üu ile kategori ekleme
      document.getElementById('newCategory').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          addCategory();
        }
      });
      
      // √úr√ºn ekleme formu
      elements.productForm.addEventListener('submit', addProduct);
      
      // Arama ve filtreleme
      document.getElementById('searchInput').addEventListener('input', function() {
        const searchText = this.value;
        const categoryFilter = document.getElementById('categoryFilter').value;
        const sortFilter = document.getElementById('sortFilter').value;
        renderProducts(searchText, categoryFilter, sortFilter);
      });
      
      document.getElementById('categoryFilter').addEventListener('change', function() {
        const searchText = document.getElementById('searchInput').value;
        const categoryFilter = this.value;
        const sortFilter = document.getElementById('sortFilter').value;
        renderProducts(searchText, categoryFilter, sortFilter);
      });
      
      document.getElementById('sortFilter').addEventListener('change', function() {
        const searchText = document.getElementById('searchInput').value;
        const categoryFilter = document.getElementById('categoryFilter').value;
        const sortFilter = this.value;
        renderProducts(searchText, categoryFilter, sortFilter);
      });
      
      // Modal kapatma
      document.querySelectorAll('.close').forEach(closeBtn => {
        closeBtn.addEventListener('click', function() {
          this.closest('.modal').style.display = 'none';
        });
      });
      
      // Modal dƒ±≈üƒ±na tƒ±klayƒ±nca kapatma
      window.addEventListener('click', function(e) {
        if (e.target.classList.contains('modal')) {
          e.target.style.display = 'none';
        }
      });
      
      // Edit modal
      document.getElementById('editForm').addEventListener('submit', saveEdit);
      document.getElementById('cancelEdit').addEventListener('click', function() {
        elements.editModal.style.display = 'none';
      });
      
      // Stock modal
      document.getElementById('stockForm').addEventListener('submit', saveStock);
      
      // ƒ∞lk y√ºklemede verileri render et
      renderCategories();
      renderProducts();
    });
  </script>
</body>
</html>